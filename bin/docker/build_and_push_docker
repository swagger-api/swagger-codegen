#!/bin/bash

if [ "$DOCKER_HUB_USERNAME" ]; then docker login --username="$DOCKER_HUB_USERNAME" --password="$DOCKER_HUB_PASSWORD" && docker buildx build --platform linux/arm64/v8,linux/amd64 --rm=false -t "$DOCKER_GENERATOR_IMAGE_NAME" ./modules/swagger-generator && if [ -n "$CIRCLE_TAG" ]; then docker tag "$DOCKER_GENERATOR_IMAGE_NAME:latest" "$DOCKER_GENERATOR_IMAGE_NAME:$CIRCLE_TAG"; fi && if [ -n "$CIRCLE_TAG" ] || [ "$CIRCLE_BRANCH" = "master" ]; then docker push "$DOCKER_GENERATOR_IMAGE_NAME"; fi; fi
if [ "$DOCKER_HUB_USERNAME" ]; then docker login --username="$DOCKER_HUB_USERNAME" --password="$DOCKER_HUB_PASSWORD" && docker buildx build --platform linux/arm64/v8,linux/amd64 --rm=false -t "$DOCKER_CODEGEN_CLI_IMAGE_NAME" ./modules/swagger-codegen-cli && if [ -n "$CIRCLE_TAG" ]; then docker tag "$DOCKER_CODEGEN_CLI_IMAGE_NAME:latest" "$DOCKER_CODEGEN_CLI_IMAGE_NAME:$CIRCLE_TAG"; fi && if [ -n "$CIRCLE_TAG" ] || [ "$CIRCLE_BRANCH" = "master" ]; then docker push "$DOCKER_CODEGEN_CLI_IMAGE_NAME"; fi; fi